(function(n){this.jsWCRS672_InteractionPanierPlusUnMoinsUn=Utilitaires.Class.extend({defaultOptions:{dataSource:null,objDataBase:null,tagContainer:"li",selecteurBtnAjouter:"a.aWCRS310_Add",selecteurSpanQteCommandee:"span.spanWCRS310_count",selecteurBtnIncrementer:"a.aWCRS310_More",selecteurBtnDecrementer:"a.aWCRS310_Less",selecteurSpanQteCommandee:"span.spanWCRS310_count",selecteurBlocIncrementerDecrementer:".divWCRS310_BlocIncrementerDecrementer",flagVignette:!0,dsHelper:null,objAnimation:null,fnSupprimerElement:null,fnGetContenuElementParEvenement:null,objProvenanceArticle:null},init:function(t){var i=this;this.options=n.extend({},i.defaultOptions,t);i.options.dataSource&&(i.options.objDataBase=new Utl.DataBase(i.options.dataSource));i.options.objProvenanceArticle||Utl.Log.logError("140814032739 - La provenance article ne doit pas Ãªtre null !")},initFonctionnaliteSurContainer:function(){var n=this},appliquerFonctionnalite:function(n){var t=this;if(Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_AJOUTE,t.onEvenementChangementQuantite,this),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_QUANTITE_INCREMENTEE,t.onEvenementChangementQuantite,this),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_SUPPRIME,t.onEvenementSupprimerProduitDuPanier,this),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_QUANTITE_DECREMENTEE,t.onEvenementChangementQuantite,this),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_STOCK_INSUFFISANT_RISQUE,t.onEvenementStockKO,this),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_STOCK_INSUFFISANT,t.onEvenementStockKO,this),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_LIMITE_LIQUIDE_DEPASSEE,t.onEvenementLimiteLiquide,this),t.options.selecteurBtnAjouter!=null)n.on("click",t.options.selecteurBtnAjouter,function(n){n.preventDefault();n.stopPropagation();var i=t.recupererContenuParEvenementUI(n);i.objElement.iQuantitePanier++;t.onClickChangementQuantite(Managers.jsWCRS604_MgrPanier.enuTypeAction.iINCREMENTATION_QTE,i,t.options.objProvenanceArticle)});n.on("click",t.options.selecteurBtnIncrementer,function(n){n.preventDefault();n.stopPropagation();var i=t.recupererContenuParEvenementUI(n);i.objElement.iQuantitePanier++;t.onClickChangementQuantite(Managers.jsWCRS604_MgrPanier.enuTypeAction.iINCREMENTATION_QTE,i,t.options.objProvenanceArticle)});n.on("click",t.options.selecteurBtnDecrementer,function(n){n.preventDefault();n.stopPropagation();var i=t.recupererContenuParEvenementUI(n);if((i.objElement.iQuantitePanier===1||i.objElement.iQuantitePanier===i.objElement.iQteMinPanier)&&t.options.fnSupprimerElement)t.options.fnSupprimerElement.call(t,i,t.options.objDataBase.getContenusElementParIdUnique);else if(i.objElement.iQuantitePanier>0){i.objElement.iQuantitePanier--;t.onClickChangementQuantite(Managers.jsWCRS604_MgrPanier.enuTypeAction.iDECREMENTATION_QTE,i,t.options.objProvenanceArticle)}})},onClickChangementQuantite:function(n,t,i){if(t&&t.objElement){var r=Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iDEMANDE_MISE_A_JOUR_QTE).avecElement({objContenu:t,action:n,objProvenanceArticle:i});Managers.jsWCRS609_MgrEvenement.emettreEvenement(r);Managers.jsWCRS604_MgrPanier.ModifierQuantiteCommandee({objContexte:this,eTypeAction:n,iIdProduit:t.objElement.sId,iQuantite:t.objElement.iQuantitePanier,sNoPointLivraison:t.objElement.sNoPointLivraison,sUuidEmetteur:t.sUuid,objProvenanceArticle:i})}},onEvenementChangementQuantite:function(n){var r=this,i,u,t,f,e,o;if(n!=null&&(i=r.options.objDataBase.getContenusElementParIdUnique(n.objElement.sIdUnique),i&&i.length))for(u=0;u<i.length;u++)t=i[u],t&&t.objElement&&(f=0,e=0,n.objElement!=null&&(f=n.objElement.iQuantitePanier,e=n.objElement.iQteDisponible),r.appliquerChangementQte(t.objElement,f),r.appliquerChangementQteDisponible(t.objElement,e),o=t.getElementDomAssocie(),r.animerPanier(n.eTypeEvenement,o,f))},onEvenementStockKO:function(n){var u=this,t,i,r;if(n!=null&&(t=u.options.objDataBase.getContenusElementParIdUnique(n.sIdUnique),t&&t.length))for(i=0;i<t.length;i++)if(r=t[i],r&&r.objElement){var f=r.objElement,e=0,o=0;n.objElement!=null&&(e=n.objElement.iQuantitePanier,o=n.objElement.iQteDisponible);u.appliquerChangementQte(f,e);u.appliquerChangementQteDisponible(f,o)}},onEvenementSupprimerProduitDuPanier:function(n){var u=this,t,r,i,f,e;if(n!=null&&(t=u.options.objDataBase.getContenusElementParIdUnique(n.sIdUnique),t&&t.length))for(r=0;r<t.length;r++)i=t[r],i&&i.objElement&&(f=i.objElement,u.appliquerChangementQte(f,0),e=i.getElementDomAssocie(),u.animerPanier(n.eTypeEvenement,e,0))},onEvenementLimiteLiquide:function(n){var u=this,t,r,i,f,e;if(n!=null&&(t=u.options.objDataBase.getContenusElementParIdUnique(n.sIdUniqueEmetteur),t&&t.length))for(r=0;r<t.length;r++)i=t[r],i&&i.objElement&&(f=0,e=0,n.objElement!=null&&(f=n.objElement.objProduit.iQuantitePanier,e=n.objElement.objProduit.iQteDisponible),u.appliquerChangementQte(i.objElement,f),u.appliquerChangementQteDisponible(i.objElement,e))},appliquerChangementQte:function(n,t){n!=null&&(n.iQuantitePanier=t)},appliquerChangementQteDisponible:function(n,t){n!=null&&(n.iQteDisponible=t)},recupererContenuParEvenementUI:function(n){if(n){var t=this;return t.options.objDataBase.getContenuElementParEvenement(t.options.fnGetContenuElementParEvenement)(n)}return null},animerPanier:function(n,t,i){if(n){me=this;var u=t.find(me.options.selecteurBtnAjouter),e=t.find(me.options.selecteurBtnIncrementer),o=t.find(me.options.selecteurBtnDecrementer),r=t.find(me.options.selecteurSpanQteCommandee),f=t.find(me.options.selecteurBlocIncrementerDecrementer);switch(n){case Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_AJOUTE:u.hide();f.show();me.options.objAnimation.zoomPlus(r,i);break;case Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_QUANTITE_INCREMENTEE:me.options.objAnimation.zoomPlus(r,i);break;case Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_SUPPRIME:f.hide();u.css("display","block");break;case Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_QUANTITE_DECREMENTEE:me.options.objAnimation.zoomMoins(r,i);break;default:Utl.Log.logWarn("jsWCRS672_InteractionPanierPlusUnMoinsUn : Animation indefini pour cet event !!! action : "+n+"animerPanier: $elementPlusUnMoinsUn  "+t+" iQte "+i)}}},disposerFonctionnalite:function(n){Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_AJOUTE,this.onEvenementChangementQuantite,this);Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_QUANTITE_INCREMENTEE,this.onEvenementChangementQuantite,this);Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_SUPPRIME,this.onEvenementChangementQuantite,this);Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_QUANTITE_DECREMENTEE,this.onEvenementChangementQuantite,this);Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iPRODUIT_LIMITE_LIQUIDE_DEPASSEE,this.onEvenementLimiteLiquide,this);n.off("click",this.options.selecteurBtnAjouter);n.off("click",this.options.selecteurBtnDecrementer);n.off("click",this.options.selecteurBtnIncrementer)}})}).call(this.ListesProduits_Fonctionnalite_InteractionsPanier=this.ListesProduits_Fonctionnalite_InteractionsPanier||{__namespace:!0},window.jQuery);typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();