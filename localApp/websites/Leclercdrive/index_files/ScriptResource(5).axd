(function(){function f(n,t,i,u){return(n==undefined&&(n=""),i==null)?n:n.indexOf("&"+t+"=")==-1?n+"&"+t+"="+(i!=undefined?r(i,u):""):n.replace(new RegExp("&"+t+"=(.*)","gi"),function(n){var f=i!=undefined?r(i,u):"";return n=n.substring(1),n.indexOf("&")>-1&&(f=f+n.substring(n.indexOf("&"))),"&"+t+"="+f})}function r(n,t){if(n==undefined)return"";if(typeof n!="string")return n;var r="([*+?^=!:&$�<>'\"�,;{}()|\\\\])",i;return t&&t.categories?(i=new RegExp(r.replace(":",""),"g"),String.no_accent(n.replace(/  /g,"__").replace(/ /g,"_").replace(/%/g,"pct").replace(i,""))):t&&t.allow?(i=new RegExp(r.replace(t.allow,""),"g"),String.no_accent(n.replace(/  /g,"__").replace(/ /g,"_").replace(/%/g,"pct").replace(i,""))):(i=new RegExp(r,"g"),String.no_accent(n.replace(/  /g,"__").replace(/ /g,"_").replace(/%/g,"pct").replace(i,"")))}function s(n,t){if(!n||!n.length)return"";var i=$.map(n,function(n){return r(n)});return t?i.join("::")+"::":i.join("::")}function h(n,t){return"_xtc"+t+n.selecteur+(n.event||"")}function c(n,t,r){if(n)if(n.delegation)$(document).ensureUnique(h(n,t)).on(n.event||"click"+i.eventNamespace+t,n.selecteur,n,$.proxy(r,this));else{var u=$(n.selecteur);n.filtre&&(u=u.filter(n.filtre));u.ensureUnique(h(n,t)).on(n.event||"click"+i.eventNamespace+t,null,n,$.proxy(r,this))}}function l(n,t){n&&(n.delegation?$(document).removeData(h(n,t)).off(n.event||"click"+i.eventNamespace+t,n.selecteur):(selection=$(n.selecteur),n.filtre&&(selection=selection.filter(n.filtre)),selection.removeData(h(n,t)).off(n.event||"click"+i.eventNamespace+t)))}function v(n){var t,u=xtel.xttab.length,i,r;try{t=(n||document).querySelectorAll("*")}catch(f){t=document.getElementsByTagName("*")}for(i=0;i<t.length;i++)xtL(t[i])&&xtel.xttab.push(t[i]),xtLDz(t[i])&&obj.push(t[i]);for(r=u;r<xtel.xttab.length;r++)xd.addEventListener?xtel.xttab[r].addEventListener("mousedown",xtR,fA):xd.attachEvent&&xtel.xttab[r].attachEvent("onmousedown",xtR)}function k(){for(var n=0;n<obj.length;n++)xtcz[n]=xtG(obj[n],cZ),typcz[n]=xtG(obj[n],dT)!=nu&&xtG(obj[n],dT)!=un?xtG(obj[n],dT):"0",sizex[n]=xtSx(obj[n]),sizey[n]=xtSy(obj[n]),posx[n]=xtPx(obj[n]),posy[n]=xtPy(obj[n]),timecz[xtcz[n]]=0,timerefcz[xtcz[n]]=0,timercz[xtcz[n]]=nu;xtReload()}var i;this.Evenements.Xiti={CONFIG:"config.xiti"};i={eventNamespace:".xiti",eMode:{iDEFAULT:1,iCLICKZONE:2},defaults:function(){return{serveurCollecte:window.xtsd||"",domaine:window.xt1||"",mode:i.eMode.iDEFAULT,site1:window.xtsite||"",site2:window.xtn2||"",chapitres:[],rayons:[],page:window.xtpage||"",degreImplication:window.xtdi||0,publicites:window.xt_ati?window.xt_ati.split(","):[],utilisateur:{id:null,categorie:null},recherche:{expr:null,numPage:null},indicateurs:[],indicateursPage:[],commande:{id:null,panier:null,roi:0,montant:0,montantHT:0,remise:0,remiseHT:0,livraison:0,livraisonHT:0,tax:0,etat:0,nouveau:0,indicateurs:[],typePaiement:1,typeLivraison:null,codePromo:null},idModele:"",enable:!0,scripts:[],definitions:null}}};var n={global:function(n){return function(t){window[n]=t.newValue}},paramsValue:function(n){return function(i){t=f(t,n,i.newValue)}},paramsObject:function(n){return function(i){if($.isPlainObject(n))for(var r in n)i.newValue[r]!==undefined&&(t=f(t,n[r],i.newValue[r]))}},paramsArray:function(n,i){return function(r){r.newValue&&r.newValue.length&&(t=f(t,n,r.newValue.join(i),{allow:i}))}},paramsArrayIndex:function(n){return function(i){if(i.newValue&&i.newValue.length)for(var r=0,u=i.newValue.length;r<u;r++)t=f(t,n+(r+1),i.newValue[r])}},paramsIndicateursCommande:function(n){return function(i){var r,e,u;if(i.newValue&&i.newValue.length)for(r=0,e=i.newValue.length;r<e;r++)u=r+1,u>=2&&(u=u+2),t=f(t,n+u,i.newValue[r])}},paramsArrayCategories:function(n){return function(i){i.newValue&&i.newValue.length&&(t=f(t,n,i.newValue.join("::"),{categories:!0}))}}},y=Utilitaires.Class.extend({init:function(n){n.ecouter("definitions",$.proxy(this.updateDef,this));n.ecouter("page",$.proxy(this.update,this))},updateDef:function(n){if(this.firstLoad=!0,n.newValue&&typeof n.newValue=="string"){var t=this;$.ajax({dataType:"script",cache:!0,url:n.newValue});return}this.definitions=n.newValue;this.update({oldValue:this.page,newValue:this.page})},update:function(n){if(this.page=n.newValue,n.newValue&&n.newValue!=""&&this.definitions){n.oldValue&&this.removeDefinitions(this.definitions[n.oldValue.toLowerCase()]);var t=this.definitions[n.newValue.toLowerCase()];this.definitionsActives={clicks:(this.definitions["*"]&&this.definitions["*"].clicks?this.definitions["*"].clicks:[]).concat(t&&t.clicks?t.clicks:[]),clickzone:{zones:(this.definitions["*"]&&this.definitions["*"].clickzone&&this.definitions["*"].clickzone.zones?this.definitions["*"].clickzone.zones:[]).concat(t&&t.clickzone&&t.clickzone.zones?t.clickzone.zones:[]),libelles:(this.definitions["*"]&&this.definitions["*"].clickzone&&this.definitions["*"].clickzone.libelles?this.definitions["*"].clickzone.libelles:[]).concat(t&&t.clickzone&&t.clickzone.libelles?t.clickzone.libelles:[])},publicites:(this.definitions["*"]&&this.definitions["*"].publicites?this.definitions["*"].publicites:[]).concat(t&&t.publicites?t.publicites:[]),publisher:(this.definitions["*"]&&this.definitions["*"].publisher?this.definitions["*"].publisher:[]).concat(t&&t.publisher?t.publisher:[])};this.updateDefinitions(this.definitionsActives);this.firstLoad=!1}},updateDefinitions:function(n){n&&(Utilitaires.Xiti.mode()!=i.eMode.iCLICKZONE?this.addClicks(n.clicks):n.clickzone&&(this.creationZones(n.clickzone.zones),this.creationLibellesZone(n.clickzone.libelles)),this.addPublicitesClicks(n.publicites),this.addPublisherClicks(n.publisher))},removeDefinitions:function(n){n&&(this.removePublicitesClicks(n.publicites),this.removePublisherClicks(n.publisher),Utilitaires.Xiti.mode()!=i.eMode.iCLICKZONE)&&this.removeClicks(n.clicks)},addClicks:function(n){if(n&&n.length)for(var t=0,r=n.length,i;t<r;t++)(i=n[t],i)&&c.call(this,i,"click",this.click)},removeClicks:function(n){if(n&&n.length)for(var t=0,r=n.length,i;t<r;t++)(i=n[t],i)&&l.call(this,i,"click")},creationZones:function(n){if(n&&n.length)for(var r=0,u=n.length,t,i;r<u;r++)(t=n[r],t)&&(i=$(t.selecteur),t.filtre&&(i=i.filter(t.filtre)),i.attr("xtcz",t.id))},creationLibellesZone:function(n){if(n&&n.length)for(var r=0,u=n.length,t,i;r<u;r++)(t=n[r],t)&&(i=$(t.selecteur),t.filtre&&(i=i.filter(t.filtre)),i.attr("xtclib",t.libelle))},addPublicitesClicks:function(n){if(n&&n.length)for(var t=0,r=n.length,i;t<r;t++)(i=n[t],i)&&c.call(this,i,"pub",this.publicite)},removePublicitesClicks:function(n){if(n&&n.length)for(var t=0,r=n.length,i;t<r;t++)(i=n[t],i)&&l.call(this,i,"pub")},addPublisherClicks:function(n){if(n&&n.length)for(var t=0,r=n.length,i;t<r;t++)(i=n[t],i)&&c.call(this,i,"publisher",this.publisher)},removePublisherClicks:function(n){if(n&&n.length)for(var t=0,r=n.length,i;t<r;t++)(i=n[t],i)&&l.call(this,i,"publisher")},click:function(n){Utilitaires.Xiti.click($.extend({},n.data,{target:n.target,libelle:n.data.libelle?$.isFunction(n.data.libelle)?n.data.libelle.call(n.target):n.data.libelle:$(n.target).text(),chapitres:$.isFunction(n.data.chapitres)?n.data.chapitres.call(n.target):n.data.chapitres}))},publicite:function(n){Utilitaires.Xiti.publicite($.extend({},n.data,{target:n.target,libelle:n.data.libelle?$.isFunction(n.data.libelle)?n.data.libelle.call(n.target):n.data.libelle:$(n.target).text()}))},publisher:function(n){Utilitaires.Xiti.publisher($.extend({},n.data,{target:n.target,libelle:n.data.libelle?$.isFunction(n.data.libelle)?n.data.libelle.call(n.target):n.data.libelle:$(n.target).text()}))}}),p=Utilitaires.Class.extend({init:function(n){this.options=n},action:function(n){if(xt_rm){var t=n.type,i="&rmp=0&rmpf=0&rmbufp=0";return n.player&&(t+="&plyr="+n.player),n.position&&(i="&rmp="+(n.position.avant||0)+"&rmpf="+(n.position.apres||0)+"&rmbufp="+(n.position.cache||0)),xt_rm(t,n.site2||this.options.lire("site2"),r(n.libelle,{categories:!0}),n.action,n.timer||null,n.total||"",i,n.flux||"",n.localisation||"int",n.mode||"clip",n.taille||"",n.format||"","","")}}}),e={panier:[n.paramsValue("idcart"),n.global("xtidcart")],id:[n.paramsValue("cmd"),n.global("xt_orderid")],roi:n.paramsValue("roimt"),montant:n.paramsValue("mtttc"),montantHT:n.paramsValue("mtht"),remise:n.paramsValue("dsc"),remiseHT:n.paramsValue("dscht"),livraison:n.paramsValue("fp"),livraisonHT:n.paramsValue("fpht"),tax:n.paramsValue("tax"),etat:n.paramsValue("st"),nouveau:n.paramsValue("newcus"),indicateurs:n.paramsIndicateursCommande("o"),typePaiement:n.paramsValue("mp"),typeLivraison:n.paramsValue("dl"),codePromo:n.paramsValue("pcd")},w=Utilitaires.Class.extend({init:function(n){n.ecouter("commande",$.proxy(this.updateCommande,this));window.xt_cart=$.proxy(this.loadProduits,this)},updateCommande:function(n){var t,i,r;if(this.commande=n.newValue,this.valid())for(t in n.newValue)if(e[t])if(typeof e[t]=="object"&&e[t].length)for(i=0,r=e[t].length;i<r;i++)e[t][i].call(this,{newValue:n.newValue[t]});else e[t].call(this,{newValue:n.newValue[t]})},loadProduits:function(){var n,t,i;if(this.commande&&this.commande.produits&&window.xt_addProduct_v2)for(t=0,i=this.commande.produits.length;t<i;t++)(n=this.commande.produits[t],n)&&window.xt_addProduct_v2(this.getCategoriesProduit(n),r(n.libelle,{categories:!0}),n.quantite,n.prix,n.prixHT,n.remise,n.remiseHT,n.codePromo,n.total)},getCategoriesProduit:function(n){return!n||!n.categories?"":s(n.categories)},valid:function(){return this.commande.panier&&this.commande.id&&this.commande.roi>0}}),u=!1,o=0,t="",b={serveurCollecte:n.global("xtsd"),domaine:n.global("xt1"),site1:n.global("xtsite"),site2:n.global("xtn2"),rayons:n.paramsArrayCategories("aisl"),degreImplication:n.paramsValue("di"),publicites:n.paramsArray("ati",","),utilisateur:n.paramsObject({id:"an",categorie:"ac"}),recherche:n.paramsObject({expr:"mc",numPage:"np"}),indicateurs:n.paramsArrayIndex("x"),indicateursPage:n.paramsArrayIndex("f"),idModele:n.global("xtidmod")},a=!1;this.Xiti={init:function(n){if(!u){u=!0;n=$.extend(!0,i.defaults(),n);this.options=new Utilitaires.Donnees.Dictionnaire;var r=this;$(document).trigger(Utilitaires.Evenements.Xiti.CONFIG,n);r.options.ecouter(b);r.options.ecouter("mode",function(n){n.newValue==i.eMode.iCLICKZONE&&(window.xtergo="1")});r.options.ecouter("page",function(n){var i;if(n.newValue){var u=function(n){var t=null;switch(n){case"2":t="--TRI--PRIX-CROISSANT";break;case"3":t="--TRI--PRIX-DECROISSANT";break;case"4":t="--TRI--PRIX_UNITE-CROISSANT";break;case"5":t="--TRI--PRIX_UNITE-DECROISSANT";break;case"6":t="--TRI--MARQUE-CROISSANT";break;case"7":t="--TRI--MARQUE-DECROISSANT"}return t},f=function(){var t=window.location.href,n={};return t.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(t,i,r,u){n[i]=u}),n},e=function(){var t=f(),n=t.Tri;if(n&&n.length>0)return u(n)},t=e();t&&t.length>0&&(i=r.options.lire("chapitres"),i.push(t),r.options.ecrire("chapitres",i));window.xtpage=r._getLibelleChapitres()+n.newValue}});r.options.ecrire(n).done(function(){if(window.xtparam=(window.xtparam||"")+t,r.enabled()&&window.xtpage!=undefined&&window.xtpage!="")o=1,r._chargerScripts(n.scripts);else o=2});r.clickManager=new y(r.options);r.mediaManager=new p(r.options);r.commandeManager=new w(r.options)}},_chargerScripts:function(n){var t=this;$.each(n,function(n,u){(function(){var n=document.createElement("script"),f;n.type="text/javascript";n.async=!0;n.src=u;(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.getElementsByTagName("script")[0].parentNode).insertBefore(n,null);f=!1;n.onload=n.onreadystatechange=function(){if(!f&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){if(f=!0,typeof window.waspxit_lstMarqueursMVTest!="undefined"&&window.waspxit_lstMarqueursMVTest.length>0&&window.waspxit_lstMarqueursMVTest.forEach(function(n,i){i>0&&(xt_abmv=n,xt_abmvc=[],xt_mvt(t._getLibelleChapitres()+r(t.options.lire("page")),t.options.lire("site2"),xt_abmv,xt_abmvc))}),t.options.lire("mode")!=i.eMode.iCLICKZONE)return;xtNa=function(n){return function(i){var f=n(i),o=$(i),u,h,c,e,l;if(t.clickManager.definitionsActives&&t.clickManager.definitionsActives.clicks)for(e=0,l=t.clickManager.definitionsActives.clicks.length;e<l;e++)if(o.closest(t.clickManager.definitionsActives.clicks[e].selecteur).length)return u=t.clickManager.definitionsActives.clicks[e],h=u.libelle?$.isFunction(u.libelle)?u.libelle.call(i):u.libelle:o.text(),c=u.chapitres?$.isFunction(u.chapitres)?s(u.chapitres.call(i),!0):s(u.chapitres,!0):t._getLibelleChapitres(),f.id=f.pag=c+r(h),f.sec=u.site2||t.options.lire("site2"),f.typ=u.type||"A",f;return f}}(xtNa);xtL=function(n){return function(t){var i=n(t);return i?i:$.data(t,"xitiClick")===!0}}(xtL);n.onload=n.onreadystatechange=null}onUpdate(function(n){onLoadComplete(function(){Utilitaires.Xiti.initClickZone(n)})})}})()})},_getLibelleChapitres:function(){return s(this.options.lire("chapitres"),!0)},configure:function(n){if(!u)throw new Error("Marqueur Xiti non initialis�.");if(n&&!n.page)this.options.ecrire("definitions",n).done(function(){Utilitaires.Xiti.initClickZone()});else{var i=this;t="";this.options.ecrire(n,{force:!0}).done(function(){window.xtparam=(window.xtparam||"")+t;o==2&&i.enabled()&&window.xtpage!=""?(o=1,i._chargerScripts(i.options.lire("scripts"))):Utilitaires.Xiti.initClickZone()})}},update:function(n){var i=this;t="";this.options.ecrire(n,{force:!0}).done(function(){if(i.enabled()&&(!n||!n.silent))return o==2&&window.xtpage!=""?(o=1,window.xtparam=(window.xtparam||"")+t,i._chargerScripts(i.options.lire("scripts"))):window.xt_med?window.xt_med("F",i.options.lire("site2"),i._getLibelleChapitres()+r(i.options.lire("page"))+t,n.type||null):void 0})},click:function(n){if(t="",this.enabled()&&n&&n.libelle&&window.xt_click)return window.xt_click(document,"C",n.site2||this.options.lire("site2"),(n.chapitres==undefined?this._getLibelleChapitres():s(n.chapitres,!0))+r(n.libelle),n.type||"A")},media:function(n){if(!u)throw new Error("Marqueur Xiti non initialis�.");this.mediaManager&&this.mediaManager.action(n)},publicite:function(n){if(t="",this.enabled()&&n&&n.libelle&&window.xt_adc)return window.xt_adc(n.target||document,r(n.libelle,{allow:","}))},publisher:function(n){if(t="",this.enabled()&&n&&n.libelle&&window.xt_click){var u=this.options.lire("serveurCollecte")+".xiti.com/go.ad?xts="+this.options.lire("site1")+"&atc="+r(n.libelle,{allow:","})+"&type=AT&url="+document.location,i=document.createElement("img");i.src=u;document.body.appendChild(i);setTimeout(function(){document.body.removeChild(i)},500)}},mode:function(){if(!u)throw new Error("Marqueur Xiti non initialis�.");return this.options.lire("mode")},enabled:function(){if(!u)throw new Error("Marqueur Xiti non initialis�.");return this.options.lire("enable")},getOptions:function(){if(!u)throw new Error("Marqueur Xiti non initialis�.");return this.options.donnees},initClickZone:function(n){if(u&&this.options.lire("mode")==i.eMode.iCLICKZONE){var t=this;setTimeout(function(){var i,r;if(t.clickManager.definitionsActives&&t.clickManager.definitionsActives.clicks)for(i=0,r=t.clickManager.definitionsActives.clicks.length;i<r;i++)$(t.clickManager.definitionsActives.clicks[i].selecteur).data("xitiClick",!0);try{if(typeof xtNodesload=="function"){if(n&&(n instanceof jQuery||$.isArray(n)))for(i=0,r=n.length;i<r;i++)v(n[i]);else v(n);k()}}catch(u){}},250)}}};window.onload=function(){Utilitaires.pubsub&&a==!1&&(a=!0,Utilitaires.pubsub.publish("XitiLoaded"))}}).call(this.Utilitaires);