(function(n){this.jsWCRS710_RendererLayoutSubscriber=function(t,i,r,u,f,e,o,s,h,c){var ut;i||Utl.Log.logError("150121024808 - Aucun objet de donnee pour definir le layout");r||Utl.Log.logError("150121024809 - Aucun $container pour definir le layout");u||Utl.Log.logError("150121024809 - Aucun objFonctionnalites pour definir le layout");f||Utl.Log.logError("150121024810 - Aucun eTypeContenu pour definir le layout");var nt=_objDataSourceGroupeTrieFiltre=i,ht=f,y=u,k=e,p=o,ft=s,d=null,a=null,et=!1,tt=!1,v=h,l=new Infomil.Api.Trade.Outils,b=c||[];y.getAsArray&&(y=u.getAsArray());var ot=function(){var n=[],t,r,u;ListesProduits.AppliquerQtesGroupesVariantes(b,window._lstQtesGroupeVariantes);t=ListesProduits.FiltrerParGroupeVariantes(_objDataSourceGroupeTrieFiltre,b,k,p);_objDataSourceGroupeTrieFiltre=t.objDatasourceResultat;for(var i=0,f=_objDataSourceGroupeTrieFiltre.length,e=ft(_objDataSourceGroupeTrieFiltre.concat(b));i<f;i++)r=e.renderElement(_objDataSourceGroupeTrieFiltre[i],d,a),n.push(r);return a&&(u=a.recupererOperation(d),n.push(u)),ListesProduits.AffecterTradeGroupeVariante(t.lstTradeGroupeVariante),n},it=function(){window.TradeGeneriqueContext.objTradeBuilder&&window.TradeGeneriqueContext.objTradeBuilder[l.sIdTradeBusiness]&&!v&&(p=window.TradeGeneriqueContext.objTradeBuilder[l.sIdTradeBusiness],_objDataSourceGroupeTrieFiltre=TradeGeneriqueContext.Datasource,l.PositionnerTrade(p,l.sIdTradeBusiness).done(function(n){p=n;window.TradeGeneriqueContext.objTradeBuilder=window.TradeGeneriqueContext.objTradeBuilder||{};window.TradeGeneriqueContext.objTradeBuilder[l.sIdTradeBusiness]=n;g(!0)}).fail(function(){g();l.GererAffichageTrade(!1,l.sIdTradeBusiness);Managers.jsWCRS609_MgrEvenement.emettreEvenement(Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE_ERREUR).avecElement({sIdTradeBusiness:l.sIdTradeBusiness,sMessage:"Erreur de dimensionnement du trade"}))}))},g=function(t){var u,f,e,i,o;if(a&&a.disposerFonctionnalites(r),k&&(d=new ListesProduits_Trade.Curseur(k.getColonnade().nb)),p&&(a=new ListesProduits_Trade.jsWCRS692_AggregateurTrade(p.build())),u=ot(d,a),f=u.join(""),r.empty(),r.html(f),t&&!v&&(l.RedimensionnerTradeGenerique(l.sIdTradeBusiness)?(l.GererAffichageTrade(!0,l.sIdTradeBusiness),Managers.jsWCRS609_MgrEvenement.emettreEvenement(Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE_OK).avecElement({sIdTradeBusiness:l.sIdTradeBusiness,sMessage:"Chargement du levier terminé."}))):(l.GererAffichageTrade(!1,l.sIdTradeBusiness),Managers.jsWCRS609_MgrEvenement.emettreEvenement(Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE_ERREUR).avecElement({sIdTradeBusiness:l.sIdTradeBusiness,sMessage:"Erreur de positionnement du trade (DOM incomplet)"})))),e=Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iCONTENU_CHARGEMENT_OK).avecElement(this._eTypeContenu),Managers.jsWCRS609_MgrEvenement.emettreEvenement(e),n.fnAfficherBtn(r),!tt){for(i=0,o=y.length;i<o;i++)y[i].appliquerFonctionnalite(r);tt=!0}a&&a.appliquerFonctionnalites(r);v?Managers.jsWCRS609_MgrEvenement.emettreEvenement(Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iLAYOUT_MDD_VIDE_AFFICHE).avecElement(_objDataSourceGroupeTrieFiltre)):Managers.jsWCRS609_MgrEvenement.emettreEvenement(Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iLAYOUT_VIDE_AFFICHE).avecElement(_objDataSourceGroupeTrieFiltre.concat(b)));et=!0;v||setTradeGeneriqueContext(_objDataSourceGroupeTrieFiltre.concat(b),k,a)},w=function(n){if(n.eTypeEvenement==Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE){var t=n.objElement.sIdTradeBusiness;l.sIdTradeBusiness=t;window.TradeGeneriqueContext.objRetourAjax&&window.TradeGeneriqueContext.objRetourAjax[t]?(window.TradeGeneriqueContext.objTradeBuilder=window.TradeGeneriqueContext.objTradeBuilder||{},window.TradeGeneriqueContext.objTradeBuilder[t]=l.CreerTradeGeneriqueBuilder(window.TradeGeneriqueContext.objRetourAjax[t],t),window.TradeGeneriqueContext.objTradeBuilder[t]?it():Managers.jsWCRS609_MgrEvenement.emettreEvenement(Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE_ERREUR).avecElement({sIdTradeBusiness:t,sMessage:"Erreur de création du Builder Trade Génériques"}))):Managers.jsWCRS609_MgrEvenement.emettreEvenement(Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE_ERREUR).avecElement({sIdTradeBusiness:t,sMessage:n.objElement.Message}))}else _objDataSourceGroupeTrieFiltre=n.objElement?n.objElement(nt):nt,rt()},rt=function(){if(window.TradeGeneriqueContext.objTradeBuilder&&!v){var t=Object.keys(window.TradeGeneriqueContext.objTradeBuilder);n(t).each(function(n,t){window.TradeGeneriqueContext.objTradeBuilder[t]&&(l.sIdTradeBusiness=t,l.RafraichirTradeGenerique(_objDataSourceGroupeTrieFiltre,t).done(function(){it();l.GererAffichageTrade(!0,t)}).fail(function(){g();l.GererAffichageTrade(!1,t)}))})}else g()},st=function(t){window._lstQtesGroupeVariantes||(window._lstQtesGroupeVariantes=[]);var i=!1;n(window._lstQtesGroupeVariantes).each(function(n,r){r.sIdUnique==t.objElement.sIdUnique&&(r.iQuantitePanier=t.objElement.iQuantitePanier,i=!0)});i||window._lstQtesGroupeVariantes.push(t.objElement)};return v?Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iFILTRES_TRI_PRODUITS_MDD_APPLIQUEES,w):(Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iFILTRES_TRI_PRODUITS_APPLIQUEES,w),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE,w)),Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iQUANTITE_GROUPE_VARIANTE_MODIFIEE,st,this),ut=function(){for(var n=0,t=y.length;n<t;n++)y[n].disposerFonctionnalite(r);v?Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iFILTRES_TRI_PRODUITS_MDD_APPLIQUEES,w):(Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iFILTRES_TRI_PRODUITS_APPLIQUEES,w),Managers.jsWCRS609_MgrEvenement.desabonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_TRADE_GENERIQUE,w))},{dispose:ut,reloadDOM:rt}}}).call(this.ListesProduits_Renderer=this.ListesProduits_Renderer||{__namespace:!0},window.jQuery);typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();