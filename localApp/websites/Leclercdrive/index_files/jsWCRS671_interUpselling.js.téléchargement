(function(n){var t=function(t,i,r,u,f,e,o){t||Utl.Log.logError("140814032012 - La fonction de recupêration d'un element par son uuid doit etre défini");i||Utl.Log.logError("140814032034 - La fonction de recupêration d'un element par son id unique Brii doit etre défini");r||Utl.Log.logError("140814032112 - La fonction demission des evenements doit etre défini");u||Utl.Log.logError("140814032127 - La fonction dappel ajax pour ajouter un lot homogene doit etre défini");f||Utl.Log.logError("140814032148 - Le selecteur BtnAjouterLotHomogene  doit etre défini");e||Utl.Log.logError("140814032205 - Le selecteur BtnComposerLotHeterogene doit etre défini");o||Utl.Log.logError("140814032219 - La provenance doit être définie");var v=t,k=i,y=r,it=u,p=f,w=e,c=o;c.sInformationsComplementaires=c.sInformationsComplementaires?c.sInformationsComplementaires+";p1":"p1";var s=Utilitaires.Ressources.vbNETsWCRS201.ascWCRS346_UpsellingLotHeterogene,l={},a={},b={};s||Utl.Log.logError("140814032315 - L'objet de localisation ne doit pas être null !");var h=function(t,i){var f=k(t),e;if(f&&f.length)for(e=0;e<f.length;e++){var r=f[e].sUuid,o=n(document.getElementById(r)),u=o.find("p.pWCRS310_HomogeneSucces");u.html(i);l[r]?a[r]=(new Date).getTime()+5e3:(l[r]=!0,u.removeClass("visible_false"),u.animate({opacity:1},250),a[r]=(new Date).getTime()+5e3,b[r]=setInterval(function(){(new Date).getTime()>a[r]&&u.animate({opacity:0},250,function(){u.addClass("visible_false");l[r]=!1;clearInterval(b[r])})},500))}},d=function(n){var i=new Interfaces.jsWCRS638_ItfBriiHomogene("xx",n.objElement),t;if(n.objElement.eIncitationLot==Interfaces.jsWCRS646_ItfBrii.enuIncitationLot.iACHETER_LOT||n.objElement.eIncitationLot==Interfaces.jsWCRS646_ItfBrii.enuIncitationLot.iCOMPOSER_LOT||n.objElement.eIncitationLot==Interfaces.jsWCRS646_ItfBrii.enuIncitationLot.iCOMPOSER_PACK_PROMO)switch(n.objElement.eCommunicationGains){case Interfaces.jsWCRS646_ItfBrii.enuCommunicationGains.iPRODUITS_GRATUITS:n.objElement.iNbLotsRealises===1?(t=String.format(s.tooltipHomogeneLotGratuit,n.objElement.iQuantiteRequise,n.objElement.sGainsBrii),h(n.objElement.sIdUnique,t)):n.objElement.iNbLotsRealises>1&&(n.objElement.iNbGratuits<=1?(t=String.format(s.tooltipHomogeneLotsGratuit,n.objElement.iNbLotsRealises,n.objElement.iQuantiteRequise,n.objElement.sGainsBrii),h(n.objElement.sIdUnique,t)):(t=String.format(s.tooltipHomogeneLotsGratuits,n.objElement.iNbLotsRealises,n.objElement.iQuantiteRequise,n.objElement.sGainsBrii,n.objElement.iNbGratuits),h(n.objElement.sIdUnique,t)));break;case Interfaces.jsWCRS646_ItfBrii.enuCommunicationGains.iEUROS:n.objElement.iNbLotsRealises===1&&(t=String.format(s.tooltipHomogeneLotGains,n.objElement.iQuantiteRequise,n.objElement.sGainsBrii),h(n.objElement.sIdUnique,t));n.objElement.iNbLotsRealises>1&&(t=String.format(s.tooltipHomogeneLotsGains,n.objElement.iNbLotsRealises,n.objElement.iQuantiteRequise,n.objElement.sGainsBrii),h(n.objElement.sIdUnique,t))}},g=function(n){var i=Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iAJOUT_LOT_HOMOGENE).avecElement(n.objElement),t;y(i);t=null;switch(n.objElement.sType){case"Produit":t=n.objElement.sNoPointLivraison;break;case"BriiHomogene":t=n.lstEnfants[0].objElement.sNoPointLivraison;break;default:Utl.Log.logError("fnAjoutLotHomogene - sType inconnue")}u({sNoPointLivraison:t,sId:n.objElement.sId,objProvenanceArticle:c})},nt=function(n){n.on("click",w,function(n){var t,i;n.preventDefault();n.stopPropagation();t=v(n);t.objElement.sType=="BriiHeterogene"&&(t.objElement.sCodeLotHeterogene=t.objElement.sId);i=null;i=t.objElement.eIncitationLot==Interfaces.jsWCRS646_ItfBrii.enuIncitationLot.iCOMPOSER_PACK_PROMO?Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iCOMPOSER_PACK_PROMO).avecElement(t.objElement):Interfaces.jsWCRS642_ItfEvenement.avecTypeEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementClient.iCOMPOSER_BRII_HETEROGENE).avecElement(t.objElement);i&&y(i)});n.on("click",p,function(n){n.preventDefault();n.stopPropagation();var t=v(n);g(t)});Managers.jsWCRS609_MgrEvenement.abonnerEvenement(Interfaces.jsWCRS642_ItfEvenement.enuTypeEvenementServeur.iBRII_HOMOGENE_VALIDE,d,this)},tt=function(n){n.off("click",p);n.off("click",w)};return{appliquerFonctionnalite:nt,disposerFonctionnalite:tt}};this.jsWCRS671_InteractionPanierUpselling=function(){var n,i,r,u,f,e,o,s=function(t){return n=t,this},h=function(n){return i=n,this},c=function(n){return r=n,this},l=function(n){return u=n,this},a=function(n){return f=n,this},v=function(n){return e=n,this},y=function(n){return o=n,this},p=function(){return new t(n,i,r,u,f,e,o)};return{build:p,avecGetContenuElementParEvenement:s,avecGetProduitsByIdUniqueBrii:h,avecEmettreEvenement:c,avecAppelAjouterLotHomogene:l,avecSelecteurBtnAjouterLotHomogene:a,avecSelecteurBtnComposerLotHeterogene:v,avecProvenanceArticle:y}}}).call(this.ListesProduits_Fonctionnalite=this.ListesProduits_Fonctionnalite||{__namespace:!0},window.jQuery);typeof Sys!="undefined"&&Sys.Application.notifyScriptLoaded();